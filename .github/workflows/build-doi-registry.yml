name: Build DOI Registry (Debug)

on:
  issues:
    types: [opened, edited, closed, reopened]
  workflow_dispatch:

permissions:
  contents: write
  issues: read

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Debug â€“ list issues
        uses: actions/github-script@v7
        with:
          script: |
            console.log("DEBUG: workflow started");

            const owner = context.repo.owner;
            const repo = context.repo.repo;

            const issues = await github.paginate(
              github.rest.issues.listForRepo,
              {
                owner,
                repo,
                labels: "doi-record",
                state: "open"
              }
            );

            console.log("DEBUG: issues found =", issues.length);

            for (const issue of issues) {
              console.log("DEBUG ISSUE BODY:");
              console.log(issue.body);
              console.log("---- END ISSUE ----");
            }
